# Redis Cluster

单机Redis虽然能提供10w/s左右的qps。但是在可用性以及高并发能力仍存在一些不足：

- 单机Redis挂掉之后服务不可用
- 单机并发qps受到单机性能上限限制

此时可以使用Redis集群替代单机版，集群通过分片进行数据共享，并提供复制和故障转移功能。

## 1. Redis Cluster介绍

在Redis集群由多个节点组成，每个节点中划分不同的数据槽，key存储在不同的数据槽中。

Redis会设置16384个hash槽，并将hash槽分配给集群中所有的节点。如果对某个key进行操作时，请求先发送到某个节点中，该节点判断key是否在当前节点中，如果不在当前节点中，则将请求move到对应节点中，执行相应操作。

Redis单集群上限为1000个节点。

在集群模式只能使用DB 0。

1. 集群启动流程

   在配置文件中配置`cluster-enabled yes`，表明开启一个集群模式的redis server

2. 其他节点加入集群流程

   如当前已经开启的是7001端口的server，此时开启了一个7002端口的server，需要将7002的server加入7001server时，在7001 server的集群中执行命令``

3. 

### 1.1 hash槽分配逻辑

### 1.2 key请求原理

### 1.3 python操作Redis集群